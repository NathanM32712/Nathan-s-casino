<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>5 Card Draw — You vs Bots</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{margin:0;padding:0;background:#0a1018;color:#e6faff;font-family:Segoe UI,Roboto,system-ui}
    .wrap{max-width:900px;margin:40px auto;padding:20px}
    h1{text-align:center;color:#00aaff;font-size:22px;margin-bottom:12px}
    .table{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;justify-items:center}
    .seat{background:#0f1f2a;padding:16px;border-radius:12px;width:220px;text-align:center;box-shadow:0 8px 30px rgba(0,0,0,0.5)}
    .name{font-weight:700;font-size:18px;margin-bottom:6px}
    .status{font-size:13px;color:#9bd6ff;margin-top:6px}
    .hand{margin-top:8px;font-size:14px;color:#9bd6ff}
    .btn{margin:12px auto;background:linear-gradient(180deg,#00aaff,#0088cc);color:#001;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer;display:block}
    .log{margin-top:20px;background:#06131b;padding:12px;border-radius:8px;font-family:monospace;white-space:pre-wrap}
    .actions{margin-top:12px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>5 Card Draw — You vs Bots</h1>
    <div class="actions" id="actions"></div>
    <div class="table" id="table"></div>
    <div class="log" id="log">Game log will appear here…</div>
  </div>

  <script>
    const suits = ["♠", "♥", "♦", "♣"];
    const ranks = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];
    let deck = [];

    function createDeck(){
      deck = [];
      for(const suit of suits){
        for(const rank of ranks){
          deck.push(`${rank}${suit}`);
        }
      }
      deck.sort(()=>Math.random()-0.5);
    }

    function drawCard(){
      return deck.pop();
    }

    function dealHand(){
      return Array.from({length:5}, ()=> drawCard());
    }

    function scoreHand(hand){
      const counts = {};
      hand.forEach(card => {
        const rank = card.slice(0,-1);
        counts[rank] = (counts[rank] || 0) + 1;
      });
      const values = Object.values(counts).sort((a,b)=>b-a);
      if(values[0] === 4) return 7;
      if(values[0] === 3 && values[1] === 2) return 6;
      if(values[0] === 3) return 3;
      if(values[0] === 2 && values[1] === 2) return 2;
      if(values[0] === 2) return 1;
      return 0;
    }

    const botNames = ["Bluffzilla","TiltBot","LuckyLou"];
    let bots = [];
    let player = { name: "You", bank: 50000, hand: [], status: "Waiting", folded: false };
    let turn = 0;

    function setupGame(){
      createDeck();
      bots = botNames.map(name => ({
        name,
        risk: Math.floor(Math.random()*10)+1,
        bluff: Math.floor(Math.random()*10)+1,
        bank: Math.floor(Math.random()*90000)+10000,
        hand: [],
        status: "Waiting",
        folded: false
      }));
      player.hand = [];
      player.status = "Waiting";
      player.folded = false;
      turn = 0;
      renderTable();
      log("Game setup complete. Click an action to begin.");
      showActions(["Ante"]);
    }

    function renderTable(){
      const table = document.getElementById('table');
      table.innerHTML = '';
      const all = [player, ...bots];
      all.forEach(p => {
        const seat = document.createElement('div');
        seat.className = 'seat';
        seat.innerHTML = `
          <div class="name">${p.name}</div>
          <div class="status">${p.status}</div>
          ${p.name === "You" && p.hand.length ? `<div class="hand">Your hand: ${p.hand.join(" ")}</div>` : ""}
        `;
        table.appendChild(seat);
      });
    }

    function log(msg){
      const logEl = document.getElementById('log');
      logEl.textContent += "\n" + msg;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function showActions(actions){
      const act = document.getElementById('actions');
      act.innerHTML = '';
      actions.forEach(label => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.textContent = label;
        btn.onclick = ()=> handleAction(label);
        act.appendChild(btn);
      });
    }

    function handleAction(action){
      if(turn === 0 && action === "Ante"){
        player.bank -= 100;
        bots.forEach(b => b.bank -= 100);
        player.status = "Ante posted";
        bots.forEach(b => b.status = "Ante posted");
        log("All players posted ante.");
        turn++;
        showActions(["Deal"]);
      } else if(turn === 1 && action === "Deal"){
        player.hand = dealHand();
        bots.forEach(b => b.hand = dealHand());
        player.status = "Cards dealt";
        bots.forEach(b => b.status = "Cards dealt");
        log("Cards dealt to all players.");
        turn++;
        showActions(["Fold","Call","Raise"]);
      } else if(turn === 2){
        player.status = action;
        if(action === "Fold") player.folded = true;
        bots.forEach(b => {
          const a = b.risk + b.bluff > 12 ? "Raise" : b.risk > 5 ? "Call" : "Fold";
          b.status = a;
          if(a === "Fold") b.folded = true;
        });
        log("First betting round complete.");
        turn++;
        showActions(["Draw 0","Draw 1","Draw 2","Draw 3"]);
      } else if(turn === 3){
        const drawCount = parseInt(action.split(" ")[1]);
        player.hand.splice(0, drawCount);
        for(let i=0;i<drawCount;i++) player.hand.push(drawCard());
        player.status = `Drew ${drawCount}`;
        bots.forEach(b => {
          if(b.folded) return;
          const dc = Math.floor(5 - b.risk / 2);
          b.hand.splice(0, dc);
          for(let i=0;i<dc;i++) b.hand.push(drawCard());
          b.status = `Drew ${dc}`;
        });
        log("Draw phase complete.");
        turn++;
        showActions(["Check","Call","Raise"]);
      } else if(turn === 4){
        player.status = action;
        bots.forEach(b => {
          if(b.folded) return;
          const a = b.bluff > 7 ? "Bluff Raise" : b.risk > 6 ? "Call" : "Check";
          b.status = a;
        });
        log("Final betting round complete.");
        turn++;
        showActions(["Showdown"]);
      } else if(turn === 5 && action === "Showdown"){
        const contenders = [player, ...bots].filter(p => !p.folded);
        contenders.forEach(p => {
          p.status = "Hand: " + p.hand.join(" ");
          p.score = scoreHand(p.hand);
        });
        contenders.sort((a,b)=>b.score - a.score);
        const winner = contenders[0];
        if(winner.name === "You"){
          log("✅ You won!");
        } else {
          log(`❌ You lost. Winner: ${winner.name}`);
        }
        showActions([]);
      }
      renderTable();
    }

    setupGame();
  </script>
</body>
</html>
